# Лабораторная работа №10.  Загрузка системы

## Порядок работы

### Попасть в систему без пароля несколькими способами
#### Способ 1: `init=/bin/sh`
* При старте гостевой ОС в GUI окне VirtualBox во время отображения меню выбора загрузочного ядра, нажать кнопку **e** *(edit)* и в появившемся окне с конфигурациеq загрузки в конце строки, начинающейся с `linux16`, добавить `init=/bin/sh` и удалить `console=tty0 console=ttyS0,115200n8` 

![Правка конфига Способ 1](/Lab_10/imgs/scr_1_1.png)

* Нажать **сtrl-x** для загрузки в систему. Рутовая файловая система при этом монтируется в режиме **Read-Only**. Чтобы  перемонтировать ее в режим **Read-Write** выполняется команда `mount -o remount,rw /`. После этого  можно проверить, записав данные в любой файл или прочитав вывод команды: `mount | grep Otus` *(вместо **ro** - **rw**)*

![Перемонтирование в rw и результат](/Lab_10/imgs/scr_1_2.png)

#### Способ 2: `rd.break` (прерывание загрузки)
* После рестарта гостевой ОС аналогично провалиться в конфигурацию загрузки и  добавить  в конце строки начинающейся с `linux16` - `rd.break`

![Правка конфига Способ 2](/Lab_10/imgs/scr_2_1.png)

* После Нажатия **сtrl-x** система загружается в **emergency mode**. Корневая файловая система смонтирована в режиме **Read-Only** и видна как **/sysroot**. Чтобы получить к ней доступ нужно ее перемонтировать с правами для записи и сделать временным корнем. Далее проводится смена пароля. 

![Перемонтирование в rw и смена пароля](/Lab_10/imgs/scr_2_2.png)

#### Способ 3: `rw init=/sysroot/bin/sh`
* После рестарта гостевой аналогично провалиться в конфигурацию загрузки и  заменить  `ro` на  `rw init=/sysroot/bin/sh`

![Правка конфига Способ 3](/Lab_10/imgs/scr_3_1.png)

* После Нажатия **сtrl-x** система загружается в **emergency mode**. Корневая файловая система смонтирована в режиме **Read-Write** и видна как **/sysroot**. Нужно сделать её  временным корнем. Далее проводится смена пароля. 

![смена пароля](/Lab_10/imgs/scr_3_2.png)

### Установить систему с LVM, после чего переименовать VG. Добавить модуль в initrd
* Протокол работы приведён в файле [typescript.txt](https://github.com/OlegLitvintsev/OTUS_Labs/blob/master/Lab_10/typescript.txt) 
и результат в виде пингвина на загрузке 

![пингвин при загрузке](/Lab_10/imgs/scr_dracut.png)

